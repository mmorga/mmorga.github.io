
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Making the Windows Shell Livable - Comanche Hill</title>
  <meta name="author" content="Mark Morga">

  
  <meta name="description" content="Back when I last &ldquo;did&rdquo; Windows development, .Net didn&rsquo;t exist and the Windows CMD prompt was
one of the first things I replaced ( &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://mmorga.github.io/blog/2012/07/31/making-the-windows-shell-livable">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Comanche Hill" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
    <link href='https://fonts.googleapis.com/css?family=Lato|Montserrat:700' rel='stylesheet' type='text/css'>

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-12992468-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Comanche Hill</a></h1>
  
    <h2>Mark Morga&#8217;s Blog.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:mmorga.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Making the Windows Shell Livable</h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-07-31T16:44:00-05:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>31</span><span class='date-suffix'>st</span>, <span class='date-year'>2012</span></span> <span class='time'>4:44 pm</span></time>
        
           | <a href="#disqus_thread"
             data-disqus-identifier="http://mmorga.github.io">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>Back when I last &ldquo;did&rdquo; Windows development, .Net didn&rsquo;t exist and the Windows CMD prompt was
one of the first things I replaced (with Cygwin). Unfortunately, last time I helped someone with a Windows
machine the Cygwin install didn&rsquo;t go well - it seemed to be mired in the past, was slow, and the
git version included did not work for some reason with the repos we needed to use.</p>

<p>Fast forward to the last couple of weeks. I&rsquo;m in the process of learning C# and .Net to help build
a new framework with a team and I&rsquo;m running Windows 7 in a VM. So I&rsquo;m coming to Windows fresh after a break
of almost 8 years. The good news so far has been than C# strikes me much better than Java did (when I last
used it) and that the .Net environment is pretty easy to get learning.  Some DLL hell still exists (which
I ran into using the ZeroMQ NuGet libraries), but for the most part it has been fairly pleasant. Unfortunately,
the old Windows CMD prompt is unchanged from all those years ago. Despair sets in.</p>

<p>Then I learned about <a href="http://technet.microsoft.com/en-us/library/bb978526.aspx">PowerShell</a>. After giving
it a whirl and learning a thing or two, I&rsquo;ve finally got a very usable shell configuration for Windows
development that doesn&rsquo;t make me weep every time I have to use it. Here&rsquo;s how I have it configured.</p>

<p>On my VM, PowerShell comes pre-installed, you may need to download it
depending on your version of Windows.</p>

<h2>Console2</h2>

<p>First I installed <a href="http://sourceforge.net/projects/console/">Console2</a>. Console is a Windows GUI which wraps
the shell of your choice and adds: multiple tabs, text editor-like text selection, different background types, alpha and color-key transparency, configurable font, different window styles, hot-key mapping, etc.  This step isn&rsquo;t strictly necessary
but I like having a more responsive window for my shell and I use tabs often in iTerm on the mac.</p>

<p>I configure Console to use PowerShell by starting Console, selecting the Edit->Settings menu, then selecting the
PowerShell exe in the &ldquo;Shell&rdquo; chooser which on my machine is located at: &ldquo;C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe&rdquo;.</p>

<h2>Git</h2>

<p>A lot of Windows developers seem GUI bound which is an unfair self-limitation to impose. I install the git version from
the primary <a href="http://git-scm.com">Git</a> site. <a href="http://git-scm.com/download/win">Download</a></p>

<p>When installing, Git offers you the choice to install git for Git Bash only or for general use. I chose the general
purpose case.</p>

<h2>Configuring Git</h2>

<p>Note to self - you need to configure git to use .ssh keys in order for things to work correctly with remote repos. I&rsquo;ll
post something on this later.</p>

<h2>Installing Posh-Git into PowerShell</h2>

<p>Once you have git installed and configured, to get the most from Powershell, I recommend installing posh-git.</p>

<p>First set the security for your PowerShell instance. Run PowerShell as Administrator and type:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='powershell'><span class='line'><span class="nb">Set-ExecutionPolicy</span> <span class="n">RemoteSigned</span> <span class="n">-Confirm</span>
</span></code></pre></td></tr></table></div></figure>


<p>Make sure git can be run from your shell. If not, add it to your user&rsquo;s PATH.</p>

<p>Type the following commands to install PsGet and Posh-Git:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='powershell'><span class='line'><span class="p">(</span><span class="nb">new-object</span> <span class="n">Net</span><span class="p">.</span><span class="n">WebClient</span><span class="p">).</span><span class="n">DownloadString</span><span class="p">(</span><span class="s2">&quot;http://psget.net/GetPsGet.ps1&quot;</span><span class="p">)</span> <span class="p">|</span> <span class="n">iex</span>
</span><span class='line'><span class="n">install-module</span> <span class="n">posh-git</span>
</span></code></pre></td></tr></table></div></figure>


<p>To make it available at all times, install it in the PowerShell profile script. On my machine, this is
located in my Documents folder: WindowsPowerShell\Microsoft.PowerShell_profile.ps1.</p>

<figure class='code'><figcaption><span>Microsoft.PowerShell_profile.ps1</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class='powershell'><span class='line'><span class="nb">Push-Location</span> <span class="p">(</span><span class="nb">Split-Path</span> <span class="n">-Path</span> <span class="nv">$MyInvocation</span><span class="p">.</span><span class="n">MyCommand</span><span class="p">.</span><span class="n">Definition</span> <span class="n">-Parent</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="c"># Load posh-git module from current directory</span>
</span><span class='line'><span class="c"># Import-Module .\posh-git</span>
</span><span class='line'>
</span><span class='line'><span class="c"># If module is installed in a default location ($env:PSModulePath),</span>
</span><span class='line'><span class="c"># use this instead (see about_Modules for more information):</span>
</span><span class='line'><span class="nb">Import-Module</span> <span class="n">posh-git</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c"># Set up a simple prompt, adding the git prompt parts inside git repos</span>
</span><span class='line'><span class="k">function</span> <span class="n">prompt</span> <span class="p">{</span>
</span><span class='line'>    <span class="nv">$realLASTEXITCODE</span> <span class="p">=</span> <span class="nv">$LASTEXITCODE</span>
</span><span class='line'>
</span><span class='line'>    <span class="c"># Reset color, which can be messed up by Enable-GitColors</span>
</span><span class='line'>    <span class="nv">$Host</span><span class="p">.</span><span class="n">UI</span><span class="p">.</span><span class="n">RawUI</span><span class="p">.</span><span class="n">ForegroundColor</span> <span class="p">=</span> <span class="nv">$GitPromptSettings</span><span class="p">.</span><span class="n">DefaultForegroundColor</span>
</span><span class='line'>
</span><span class='line'>    <span class="nb">Write-Host</span><span class="p">(</span><span class="nv">$pwd</span><span class="p">)</span> <span class="n">-nonewline</span>
</span><span class='line'>
</span><span class='line'>    <span class="nb">Write-VcsStatus</span>
</span><span class='line'>
</span><span class='line'>    <span class="nv">$global:LASTEXITCODE</span> <span class="p">=</span> <span class="nv">$realLASTEXITCODE</span>
</span><span class='line'>    <span class="k">return</span> <span class="s2">&quot;&gt; &quot;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="nb">Enable-GitColors</span>
</span><span class='line'>
</span><span class='line'><span class="nb">Pop-Location</span>
</span></code></pre></td></tr></table></div></figure>


<p>Exit out of Console/PowerShell and the next time you start up, you&rsquo;ll see extra functionality for Git while in directories that
are Git repositories.</p>

<p>You can now use tab completion to complete both git commands and to fill in branch or remote names in addition to file names.</p>

<p>When you type &ldquo;git status&rdquo;, you will see color highlighting of files that helps understanding what is staged versus what
isn&rsquo;t yet.</p>

<p>Have fun.  Let me know if you have any tips for PowerShell that I should pick up.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Mark Morga</span></span>

      




<time class='entry-date' datetime='2012-07-31T16:44:00-05:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>31</span><span class='date-suffix'>st</span>, <span class='date-year'>2012</span></span> <span class='time'>4:44 pm</span></time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/console2/'>console2</a>, <a class='category' href='/blog/categories/git/'>git</a>, <a class='category' href='/blog/categories/powershell/'>powershell</a>, <a class='category' href='/blog/categories/windows/'>windows</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://mmorga.github.io/blog/2012/07/31/making-the-windows-shell-livable/" data-via="mmorga" data-counturl="http://mmorga.github.io/blog/2012/07/31/making-the-windows-shell-livable/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2012/01/01/hmm-been-a-couple-of-years/" title="Previous Post: Hmm - been a couple of years...">&laquo; Hmm - been a couple of years&#8230;</a>
      
      
        <a class="basic-alignment right" href="/blog/2012/08/10/uml-diagrams-from-graphviz/" title="Next Post: UML Diagrams from Graphviz">UML Diagrams from Graphviz &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    
<section>
  <img src="http://gravatar.com/avatar/4f530b9a625250c69465ac9c3bb028f4" alt="Gravatar image" title="Gravatar Image" />
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2012/08/10/uml-diagrams-from-graphviz/">UML Diagrams From Graphviz</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/07/31/making-the-windows-shell-livable/">Making the Windows Shell Livable</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/01/01/hmm-been-a-couple-of-years/">Hmm - Been a Couple of Years&#8230;</a>
      </li>
    
      <li class="post">
        <a href="/blog/2009/12/18/spoiler-free-avatar-review/">Spoiler Free Avatar Review</a>
      </li>
    
      <li class="post">
        <a href="/blog/2009/08/01/moved-to-slicehost/">Moved to SliceHost</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/mmorga">@mmorga</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'mmorga',
            count: 5,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>



<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/markmorga?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Mark Morga -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'markmorga';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://mmorga.github.io/blog/2012/07/31/making-the-windows-shell-livable/';
        var disqus_url = 'http://mmorga.github.io/blog/2012/07/31/making-the-windows-shell-livable/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
